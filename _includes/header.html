{%- comment -%}
  è‡ªå‹•ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ï¼ˆLiquid 3 äº’æ›ï¼‰
  å‰æ:
    - å„ãƒšãƒ¼ã‚¸ã® front matter ã« categories: [Top, Sub]ï¼ˆSub ãªã‘ã‚Œã°çœç•¥å¯ï¼‰
    - nav_order ã§ä¸¦ã³æ›¿ãˆï¼ˆæœªæŒ‡å®šã¯äº‹å®Ÿä¸Šæœ«å°¾å¯„ã‚Šï¼‰
    - hide_in_nav: true ã§éè¡¨ç¤º
{%- endcomment -%}

<div class="header">
  <div class="header-search-fixed">
    <a href="{{ '/Home/index.html' | relative_url }}" class="site-title">è„³æ³¢è§£æã‚’ãŒã‚“ã°ã‚‹</a>
    <input id="search-input" type="search" placeholder="ã‚µã‚¤ãƒˆå†…æ¤œç´¢">
    <div id="search-results" hidden>
      <ul class="hits"></ul>
    </div>
  </div>

  <table class="fixed-table">
    <thead>
      <tr>
        <th class="mokuji">ğŸ“–</th>

        {%- assign pages_sorted = site.pages | sort:"nav_order" -%}

        {%- comment -%} Topã‚«ãƒ†ã‚´ãƒªã‚’åé›† {%- endcomment -%}
        {%- assign topcats_raw = "" -%}
        {%- for p in pages_sorted -%}
          {%- if p.title and p.url and p.hide_in_nav != true and p.name != "404.html" -%}
            {%- if p.categories and p.categories.size > 0 -%}
              {%- assign top = p.categories[0] -%}
              {%- if top -%}{%- capture topcats_raw -%}{{ topcats_raw }}|||{{ top }}{%- endcapture -%}{%- endif -%}
            {%- endif -%}
          {%- endif -%}
        {%- endfor -%}
        {%- assign topcats = topcats_raw | split:"|||" | uniq | sort -%}

        {%- for topcat in topcats -%}
          {%- if topcat != "" -%}
          <th>
            <details>
              <summary>{{ topcat }}</summary>

              {%- comment -%} Subã‚«ãƒ†ã‚´ãƒªã‚’åé›†ï¼ˆç„¡ã„ãƒšãƒ¼ã‚¸ã¯ã€Œãƒ›ãƒ¼ãƒ ã€æ‰±ã„ï¼‰ {%- endcomment -%}
              {%- assign subcats_raw = "" -%}
              {%- for p in pages_sorted -%}
                {%- if p.title and p.url and p.hide_in_nav != true and p.categories and p.categories.size > 0 and p.categories[0] == topcat -%}
                  {%- if p.categories.size > 1 -%}
                    {%- assign sub = p.categories[1] -%}
                  {%- else -%}
                    {%- assign sub = "ãƒ›ãƒ¼ãƒ " -%}
                  {%- endif -%}
                  {%- capture subcats_raw -%}{{ subcats_raw }}|||{{ sub }}{%- endcapture -%}
                {%- endif -%}
              {%- endfor -%}
              {%- assign subcats = subcats_raw | split:"|||" | uniq | sort -%}

              {%- for subcat in subcats -%}
                {%- if subcat != "" -%}
                <ul class="gnav">
                  <details>
                    <summary>{{ subcat }}</summary>
                    <ul class="index">
                      {%- for page in pages_sorted -%}
                        {%- if page.title and page.url and page.hide_in_nav != true and page.categories and page.categories.size > 0 and page.categories[0] == topcat -%}
                          {%- if page.categories.size > 1 -%}
                            {%- if page.categories[1] == subcat -%}
                              <li><a href="{{ page.url | relative_url }}">{{ page.nav_title | default: page.title }}</a></li>
                            {%- endif -%}
                          {%- else -%}
                            {%- if subcat == "ãƒ›ãƒ¼ãƒ " -%}
                              <li><a href="{{ page.url | relative_url }}">{{ page.nav_title | default: page.title }}</a></li>
                            {%- endif -%}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor -%}
                    </ul>
                  </details>
                </ul>
                {%- endif -%}
              {%- endfor -%}

            </details>
          </th>
          {%- endif -%}
        {%- endfor -%}
      </tr>
    </thead>
  </table>
</div>

<style>
.fixed-table{width:100%;table-layout:fixed;border-collapse:collapse}
.fixed-table th{vertical-align:top;text-align:left;padding:.25rem .5rem}
.gnav,.index{list-style:none;margin:0;padding-left:.75rem}
.header details summary{cursor:pointer}
</style>
